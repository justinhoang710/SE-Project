{% extends 'base.html' %}
{% block content %}
<section class="card">
  <h2>Manager Dashboard</h2>
  <div class="actions">
    <a class="button" href="{{ url_for('manager_schedule') }}">Schedule for Manager</a>
    <a class="button" href="{{ url_for('manager_progress') }}">Child Progress</a>
    <a class="button" href="{{ url_for('techniques') }}">Edit Technique List</a>
  </div>
</section>

<section class="card">
  <h3>Next 2 Weeks Calendar</h3>
  <div class="calendar-grid compact-calendar">
    {% for week in calendar_weeks %}
      {% for day in week %}
        <article class="calendar-day">
          <header class="calendar-day-header">
            <h3>{{ day.weekday_short }}</h3>
            <p>{{ day.display_date }}</p>
          </header>
          <div class="calendar-shift-list">
            {% for shift in day.shifts %}
              <p class="calendar-shift-item">{{ shift.start_label }}-{{ shift.end_label }} {{ shift.class_name }} ({{ shift.employee }})</p>
            {% else %}
              <p class="hint">No shifts</p>
            {% endfor %}
          </div>
        </article>
      {% endfor %}
    {% endfor %}
  </div>
</section>

<section class="card">
  <h3>Pending Requests</h3>
  <table>
    <tr><th>Type</th><th>Requester</th><th>Target Employee</th><th>Shift</th><th>Reason</th><th>Action</th></tr>
    {% for r in pending_requests %}
      <tr>
        <td>{{ r.request_type }}</td>
        <td>{{ r.requester }}</td>
        <td>{{ r.requested_employee or '-' }}</td>
        <td>{{ r.shift_date }} {{ r.start_time }}-{{ r.end_time }} ({{ r.class_name }})</td>
        <td>{{ r.reason }}</td>
        <td>
          <form class="inline" method="post" action="{{ url_for('process_request', request_id=r.id, action='approve') }}">
            <button type="submit">Approve</button>
          </form>
          <form class="inline" method="post" action="{{ url_for('process_request', request_id=r.id, action='reject') }}">
            <button type="submit" class="danger">Reject</button>
          </form>
        </td>
      </tr>
    {% else %}
      <tr><td colspan="6">No pending requests.</td></tr>
    {% endfor %}
  </table>
</section>
{% endblock %}
